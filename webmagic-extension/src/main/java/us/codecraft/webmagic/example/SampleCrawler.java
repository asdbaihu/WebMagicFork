package us.codecraft.webmagic.example;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.apache.log4j.PropertyConfigurator;

import us.codecraft.webmagic.Spider;
import us.codecraft.webmagic.pipeline.JsonFilePipeline;
import us.codecraft.webmagic.scheduler.QueueScheduler;

public class SampleCrawler {
   
    public void doCrawl(List<String> settings)
    {

        SampleCrawlerSet sampleCrawlerSet = new SampleCrawlerSet();
        sampleCrawlerSet.URL_POST = settings.get(2);
        sampleCrawlerSet.URL_LIST = settings.get(3);
        sampleCrawlerSet.post_piece = settings.get(4);
        sampleCrawlerSet.regex_link = settings.get(5);
        sampleCrawlerSet.regex_href = settings.get(6);
        sampleCrawlerSet.regexTitle = settings.get(7);
        sampleCrawlerSet.regexContent = settings.get(8);
        
        int num = 100;
        String[] urlSeedList_content = new String[num];
        for (int pageIndex = 1; pageIndex < num + 1; ++pageIndex)
        {
          urlSeedList_content[(pageIndex - 1)] = settings.get(0) + pageIndex + settings.get(1);
        }
        String[] urlSeedList_manual = {"http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=1&_=1479223543003","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=2&_=1479223543004","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=3&_=1479223543005","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=4&_=1479223543006","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=5&_=1479223543007","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=6&_=1479223543008","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=7&_=1479223543009","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=8&_=1479223543010","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=9&_=1479223543011","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=10&_=1479223543012","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=11&_=1479223543013","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=12&_=1479223543014","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=13&_=1479223543015","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=14&_=1479223543016","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=15&_=1479223543017","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=16&_=1479223543018","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=17&_=1479223543019","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=18&_=1479223543020","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=19&_=1479223543021","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=20&_=1479223543022","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=21&_=1479223543023","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=22&_=1479223543024","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=23&_=1479223543025","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=24&_=1479223543026","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=25&_=1479223543027","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=26&_=1479223543028","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=27&_=1479223543029","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=28&_=1479223543030","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=29&_=1479223543031","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=30&_=1479223543032","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=31&_=1479223543033","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=32&_=1479223543034","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=33&_=1479223543035","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=34&_=1479223543036","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=35&_=1479223543037","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=36&_=1479223543038","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=37&_=1479223543039","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=38&_=1479223543040","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=39&_=1479223543041","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=40&_=1479223543042","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=41&_=1479223543043","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=42&_=1479223543044","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=43&_=1479223543045","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=44&_=1479223543046","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=45&_=1479223543047","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=46&_=1479223543048","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=47&_=1479223543049","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=48&_=1479223543050","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=49&_=1479223543051","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=50&_=1479223543052","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=51&_=1479223543053","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=52&_=1479223543054","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=53&_=1479223543055","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=54&_=1479223543056","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=55&_=1479223543057","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=56&_=1479223543058","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=57&_=1479223543059","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=58&_=1479223543060","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=59&_=1479223543061","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=60&_=1479223543062","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=61&_=1479223543063","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=62&_=1479223543064","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=63&_=1479223543065","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=64&_=1479223543066","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=65&_=1479223543067","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=66&_=1479223543068","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=67&_=1479223543069","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=68&_=1479223543070","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=69&_=1479223543071","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=70&_=1479223543072","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=71&_=1479223543073","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=72&_=1479223543074","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=73&_=1479223543075","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=74&_=1479223543076","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=75&_=1479223543077","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=76&_=1479223543078","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=77&_=1479223543079","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=78&_=1479223543080","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=79&_=1479223543081","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=80&_=1479223543082","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=81&_=1479223543083","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=82&_=1479223543084","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=83&_=1479223543085","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=84&_=1479223543086","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=85&_=1479223543087","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=86&_=1479223543088","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=87&_=1479223543089","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=88&_=1479223543090","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=89&_=1479223543091","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=90&_=1479223543092","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=91&_=1479223543093","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=92&_=1479223543094","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=93&_=1479223543095","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=94&_=1479223543096","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=95&_=1479223543097","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=96&_=1479223543098","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=97&_=1479223543099","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=98&_=1479223543100","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=99&_=1479223543101","http://a.jiemian.com/index.php?m=lists&a=cLists&id=33&type=wailou&notid=918856&callback=jQuery110202769260532685278_1479223543003&page=100&_=1479223543102"};
        Spider newSpider = Spider.create(sampleCrawlerSet)
          .addUrl(urlSeedList_manual)
//          .addUrl(urlSeedList_content)
          .scheduler(new QueueScheduler())
          .addPipeline(new JsonFilePipeline(settings.get(9)))
          .thread(12);
        newSpider.run();
    }

    public static void main(String[] args)
    {
    	String log4jConfPath = "D:/Sohu/sampleCrawler/webmagic-extension/src/main/resources/log4j.properties";
    	PropertyConfigurator.configure(log4jConfPath);
        SampleCrawler sampleCrawler = new SampleCrawler();
        List<List<String>> settingsList = sampleCrawler.getWebsiteSetting();
        for (List<String> settings : settingsList)
        {
            sampleCrawler.doCrawl(settings);
        }
        
    }
    private List<List<String>> getWebsiteSetting()
    {
        List<List<String>> settings = new ArrayList<List<String>>();
        settings.add(Arrays.asList("http://www.esquire.com.cn/c/featurelab?page=",
                "",
                "http://www.jiemian.com/article/[0-9]*.html",//2 post
                "http://a.jiemian.com/index.php.*",//3 list
                "http://www.esquire.com.cn/",//4 post piece
                "//a/outerHtml()",//5 regex_link
                "href=\"(.*?)\"",//6 regex_href
                "//div[@class='article-header']/h1/html()",//7 title
                "//div[@class='article-content']/html()",//8 content
                "D:/wechatData/rawData/jiemian/"
                ));
//        settings.add(Arrays.asList("http://www.esquire.com.cn/c/featurelab?page=",
//        		"",
//        		"http://www.esquire.com.cn/posts/.*",//2 post
//        		"http://www.esquire.com.cn/c/featurelab\\?page=.*",//3 list
//        		"http://www.esquire.com.cn/",//4 post piece
//        		"//a[@class='col-xs-6 cover-box']/outerHtml()",//5 regex_link
//        		"href=\"(.*?)\"",//6 regex_href
//        		"//div[@class='post-title']/html()",//7 title
//        		"//div[@class='show-content']/html()",//8 content
//        		"D:/wechatData/rawData/esquire/"
//        		));
        return settings;
    }
}
